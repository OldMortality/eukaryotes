fx <- function(l,x) {
function(x) {
n <- 54
c <- c(8,4,0.5)
sum(x * c / (exp(c * l)-1) - c * (n-x))
}
}
l.hat <- uniroot(fx(x=c(54,51,17)),lower=1e-3,upper = 10)$root
fx <- function(l,x) {
function(x) {
n <- 54
c <- c(8,4,0.5)
sum(x * c / (exp(c * l)-1) - c * (n-x))
}
}
fx <- function(l,x) {
function(l) {
n <- 54
c <- c(8,4,0.5)
sum(x * c / (exp(c * l)-1) - c * (n-x))
}
}
l.hat <- uniroot(fx(x=c(54,51,17)),lower=1e-3,upper = 10)$root
l.hat
l.hat <- uniroot(f),lower=1e-3,upper = 10)$root
l.hat <- uniroot(f,lower=1e-3,upper = 10)$root
l.hat
fx(x=c(54,51,17))
x.igf <-  <- c(54,52,23)
x.igf <- c(54,52,23)
l.hat <- uniroot(fx(x=x.igf),lower=1e-3,upper = 10)$root
l.hat
x.igf <- c(54,52,23)
x.hoxa <- c(54,51,17)
x.xeno <- c(53,39,29)
x.mdk <- c(54,47,28)
x.cdc <- c(54,53,25)
x.ilsr <- c(48,20,2)
x.igf <- c(54,52,23)
x.hoxa <- c(54,51,17)
x.xeno <- c(53,39,29)
x.mdk <- c(54,47,28)
x.cdc <- c(54,53,25)
x.ilsr <- c(48,20,2)
uniroot(fx(x=x.igf),lower=1e-3,upper = 10)$root
uniroot(fx(x=x.hoxa),lower=1e-3,upper = 10)$root
uniroot(fx(x=x.xeno),lower=1e-3,upper = 10)$root
uniroot(fx(x=x.mdk),lower=1e-3,upper = 10)$root
uniroot(fx(x=x.cdc),lower=1e-3,upper = 10)$root
uniroot(fx(x=x.ilsr),lower=1e-3,upper = 10)$root
3/l.igf
l.igf <- uniroot(fx(x=x.igf),lower=1e-3,upper = 10)$root
l.hoxa <- uniroot(fx(x=x.hoxa),lower=1e-3,upper = 10)$root
l.xeno <- uniroot(fx(x=x.xeno),lower=1e-3,upper = 10)$root
l.mdk <- uniroot(fx(x=x.mdk),lower=1e-3,upper = 10)$root
l.cdc <- uniroot(fx(x=x.cdc),lower=1e-3,upper = 10)$root
l.ilsr <- uniroot(fx(x=x.ilsr),lower=1e-3,upper = 10)$root
l.igf <- uniroot(fx(x=x.igf),lower=1e-3,upper = 10)$root
l.hoxa <- uniroot(fx(x=x.hoxa),lower=1e-3,upper = 10)$root
l.xeno <- uniroot(fx(x=x.xeno),lower=1e-3,upper = 10)$root
l.mdk <- uniroot(fx(x=x.mdk),lower=1e-3,upper = 10)$root
l.cdc <- uniroot(fx(x=x.cdc),lower=1e-3,upper = 10)$root
l.ilsr <- uniroot(fx(x=x.ilsr),lower=1e-3,upper = 10)$root
3/l.igf
3/l.hoxa
3/l.xeno
3/l.mdk
3/l.cdc
3/l.ilsr
X <- x.igf
X
loglik.f <- function(x) {
X <- x.igf
c <- c(8,4,0.5)
p <- (1-exp(-c * x))
sum(  (n-X)*log(1-p) + X * log(p))
}
curve(loglik.f,from = 0,to=2)
curve(loglik.f,from = 0,to=2)
X <- x.igf
x  = 1
c <- c(8,4,0.5)
p <- (1-exp(-c * x))
sum(  (n-X)*log(1-p) + X * log(p))
curve(loglik.f,from = 0,to=2)
p
X * log(p)
(n-X)*log(1-p)
sum(  (n-X)*log(1-p) + X * log(p))
curve(loglik.f,from = 0,to=1)
loglik.f(1)
plot('',xlim=c(0.001,2),ylim=c(-100,100))
seq(0,2,0.01)
for (i in seq(0,2,0.01)) {
points(i,loglik.f(i))
}
plot('',xlim=c(0.001,2),ylim=c(-100,100))
for (i in seq(0,2,0.01)) {
points(i,loglik.f(i),pch='.')
}
plot('',xlim=c(0.001,2),ylim=c(-100,100))
for (i in seq(0,2,0.01)) {
points(i,loglik.f(i),pch='.')
print(paste(i,loglik.f(i)))
}
abline(h=loglik.f(l.igf,col='blue'))
abline(h=loglik.f(l.igf),col='blue')
plot('',xlim=c(0.001,2),ylim=c(-100,-60))
for (i in seq(0,2,0.01)) {
points(i,loglik.f(i),pch='.')
print(paste(i,loglik.f(i)))
}
plot('',xlim=c(0.001,2),ylim=c(-100,-60))
for (i in seq(0,2,0.01)) {
points(i,loglik.f(i),pch='.')
#  print(paste(i,loglik.f(i)))
}
plot('',xlim=c(0.001,2),ylim=c(-100,-40))
for (i in seq(0,2,0.01)) {
points(i,loglik.f(i),pch='.')
#  print(paste(i,loglik.f(i)))
}
abline(h=loglik.f(l.igf),col='blue')
abline(v=l.igf,col='blue')
l.igf <- uniroot(fx(x=54 - x.igf),lower=1e-3,upper = 10)$root
l.igf
l.igf <- uniroot(fx(x=x.igf),lower=1e-3,upper = 10)$root
l.hoxa <- uniroot(fx(x=x.hoxa),lower=1e-3,upper = 10)$root
l.xeno <- uniroot(fx(x=x.xeno),lower=1e-3,upper = 10)$root
l.mdk <- uniroot(fx(x=x.mdk),lower=1e-3,upper = 10)$root
l.cdc <- uniroot(fx(x=x.cdc),lower=1e-3,upper = 10)$root
l.ilsr <- uniroot(fx(x=x.ilsr),lower=1e-3,upper = 10)$root
3/l.igf
3/l.hoxa
3/l.xeno
3/l.mdk
3/l.cdc
3/l.ilsr
fi <- -sum( x.igf * c^2 * exp(c * l.igf)/(exp(c * l) - 1)^2)
fi
c^2
x.igf
fi <- -sum( x.igf * c^2 * exp(c * l.igf)/(exp(c * l) - 1)^2)
sqrt(fi)
fi
fi <- -1 * sum( x.igf * c^2 * exp(c * l.igf)/(exp(c * l) - 1)^2)
fi
sqrt(-fi)
l.igf
c * l.igf
fi <- -1 * sum( x.igf * c^2 * exp(c * l.igf)/(exp(c * l) - 1)^2)
fi
sqrt(-fi)
1.96/sqrt(-fi)
l.ifg + 0.325
l.igf + 0.325
l.igf - 0.325
l.igf + 1.96 * sqrt(l.igf/3/54)
l.igf - 1.96 * sqrt(l.igf/3/54)
1/sqrt(36.29)
x.igf
e3 <- c(rep(1,23),rep(0,N-23))
e3 <- c(rep(1,23),rep(0,54-23))
sum(sample(e2,replace=T))
e2 <- c(rep(1,52),rep(0,2))
e3 <- c(rep(1,23),rep(0,54-23))
sum(sample(e2,replace=T))
sum(sample(e2,replace=T))
sum(sample(e2,replace=T))
for (i in 1:1000) {
x1 <- 54
x2 <- sum(sample(e2,replace=T))
x3 <- sum(sample(e3,replace=T))
}
x1 <- 54
x2 <- sum(sample(e2,replace=T))
x3 <- sum(sample(e3,replace=T))
l.igf.boot[i] <- uniroot(fx(x=c(x1,x2,x3),lower=1e-3,upper = 10))
uniroot(fx(x=c(x1,x2,x3),lower=1e-3,upper = 10)
)
c(x1,x2,x3)
l.igf.boot[i] <- uniroot(fx(x=x.boot),lower=1e-3,upper = 10)
x.boot <- c(x1,x2,x3)
l.igf.boot[i] <- uniroot(fx(x=x.boot),lower=1e-3,upper = 10)
l.igf.boot <- vector()
l.igf.boot[i] <- uniroot(fx(x=x.boot),lower=1e-3,upper = 10)
l.igf.boot[i] <- uniroot(fx(x=x.boot),lower=1e-3,upper = 10)$root
l.igf.boot[i]
x.igf
e2 <- c(rep(1,52),rep(0,2))
e3 <- c(rep(1,23),rep(0,54-23))
l.igf.boot <- vector()
for (i in 1:1000) {
x1 <- 54
x2 <- sum(sample(e2,replace=T))
x3 <- sum(sample(e3,replace=T))
x.boot <- c(x1,x2,x3)
l.igf.boot[i] <- uniroot(fx(x=x.boot),lower=1e-3,upper = 10)$root
}
hist(l.igf.boot,30)
quantile(c(0.025,0.975),igf.boot)
quantile(c(0.025,0.975),l.igf.boot)
quantile(0.025,rnorm(1000))
?quantile
quantile(l.igf.boot,c(0.025,0.975))
hist(l.igf.boot,30)
for (i in 1:2000) {
x1 <- 54
x2 <- sum(sample(e2,replace=T))
x3 <- sum(sample(e3,replace=T))
x.boot <- c(x1,x2,x3)
l.igf.boot[i] <- uniroot(fx(x=x.boot),lower=1e-3,upper = 10)$root
}
hist(l.igf.boot,30)
quantile(l.igf.boot,c(0.025,0.975))
quantile(l.igf.boot,c(ALPHA_UPPER,ALPHA_LOWER))
ALPHA_LOWER <- 0.025
ALPHA_UPPER <- 0.975
quantile(l.igf.boot,c(ALPHA_UPPER,ALPHA_LOWER))
l.igf + sqrt(l.igf) * quantile(l.igf.boot,c(ALPHA_UPPER,ALPHA_LOWER))
quantile(l.igf.boot,c(ALPHA_UPPER,ALPHA_LOWER))
quantile(l.igf.boot,c(ALPHA_UPPER,ALPHA_LOWER))
t.hat <- (l.igf.boot - l.igf)/se.star
se.star <- sqrt(var(l.igf.boot))
t.hat <- (l.igf.boot - l.igf)/se.star
hist(t.hat)
l.igf + sqrt(l.igf) * quantile(t.hat,c(ALPHA_UPPER,ALPHA_LOWER))
quantile(l.igf.boot,c(ALPHA_UPPER,ALPHA_LOWER))
l.igf - sqrt(l.igf) * quantile(t.hat,c(ALPHA_UPPER,ALPHA_LOWER))
sqrt(l.igf)
l.igf
sqrt(l.igf)
l.igf - sqrt(l.igf) * quantile(t.hat,c(ALPHA_UPPER,ALPHA_LOWER))
l.igf - sqrt(l.igf/54/3) * quantile(t.hat,c(ALPHA_UPPER,ALPHA_LOWER))
plot(x.igl ~ c)
plot(x.igf ~c
)
plot(x.igf ~log(c))
plot(x.igf ~c)
plot(x.igf ~c,xlim=c(0,1))
plot(x.igf ~c,xlim=c(0,10))
plot(x.igf ~c,xlim=c(0,10),ylim=c(0,60))
3/l.igf
abline(3/l.igf,col='blue')
plot(v=x.igf ~c,xlim=c(0,10),ylim=c(0,60))
plot(v=x.igf,col='blue')
abline(v=x.igf,col='blue')
abline(v=l.igf,col='blue')
abline(v=3/l.igf,col='blue')
plot(v=x.igf,col='blue')
plot(v=x.igf ~c,xlim=c(0,10),ylim=c(0,60))
plot(x.igf ~c,xlim=c(0,10),ylim=c(0,60))
l.igf
abline(v=3/l.igf,col='blue')
abline(h=54 * 0.95,col='blue')
96/5 * 54
0.95 * 54
x.igf[1]
##
y <- c(rep(1,x.igf[1]),rep(1,x.igf[2],rep(0,N-x.igf.2)))
##
N <- 54
y <- c(rep(1,x.igf[1]),rep(1,x.igf[2],rep(0,N-x.igf.2)))
y <- c(rep(1,x.igf[1]),
rep(1,x.igf[2]),rep(0,N-x.igf[2]),
rep(1,x.igf[3]),rep(0,N-x.igf[3]))
y <- c(rep(1,x.igf[3]),rep(0,N-x.igf[3]),
rep(1,x.igf[2]),rep(0,N-x.igf[2]),
rep(1,x.igf[1]),)
y <- c(rep(1,x.igf[3]),rep(0,N-x.igf[3]),
rep(1,x.igf[2]),rep(0,N-x.igf[2]),
rep(1,x.igf[1]))
x <- c(rep(0.5,54),rep(4,N),rep(8,N))
length(x)
length(y)
m <- glm(y~x, family=binomial)
m <- glm(y~x + x^2, family=binomial)
x
fitted(m)
summary(m)
x2 <- x ^2
m <- glm(y~x + x2, family=binomial)
summary(m)
confint(m)
m <- glm(y~x , family=binomial)
summary(m)
x2
summary(m)
plot(fitted(m)~x)
plot(fitted(m)~x,ylim=c(0,1))
fitted(m)
fitted(m)[1]
23/54
m <- lm(y~x+x^2 , family=binomial)
m <- lm(y~x+x^2 )
m <- lm(y~x+x^2 )
summary(m)
m <- lm(y~x+x^2 + x^3)
summary(m)
m <- lm(y~x+x^2 )
summary(m)
m <- glm(y~x,family=binomial )
summary(m)
for (x in seq(0,8,100)) {
points(x,invlogit(predict(m,newdata = x)))
}
invlogit(predict(m,newdata = x))
x
plot(fitted(m)~x,ylim=c(0,1))
x <- c(rep(0.5,54),rep(4,N),rep(8,N))
plot(fitted(m)~x,ylim=c(0,1))
for (i in seq(0,8,100)) {
points(i,invlogit(predict(m,newdata = i)))
}
i
invlogit(predict(m,newdata = i))
s <- seq(0,8,100)
points(s,invlogit(predict(m,newdata = s)))
s
s <- seq(0,8,100)
s
s <- seq(0,8,length.out = 100)
s
points(s,invlogit(predict(m,newdata = s)))
predict(m,newdata = s)
s
m <- glm(y~x,family=binomial )
predict(m,newdata = s)
points(s,invlogit(predict(m,newdata = data.frame(x=s))))
lines(s,invlogit(predict(m,newdata = data.frame(x=s))))
plot(fitted(m)~x,ylim=c(0,1))
s <- seq(0,8,length.out = 100)
lines(s,invlogit(predict(m,newdata = data.frame(x=s))))
s[which(s>0.95)]
min(which(s>0.95))
predictions <- predict(m,newdata = data.frame(x=s))
predictions <- invlogit(predict(m,newdata = data.frame(x=s)))
plot(fitted(m)~x,ylim=c(0,1))
s <- seq(0,8,length.out = 100)
predictions <- invlogit(predict(m,newdata = data.frame(x=s)))
lines(s,predictions)
min(which(predictions>0.95))
s[47]
gene <- x.igf
y <- c(rep(1,gene[3]),rep(0,N-gene[3]),
rep(1,gene[2]),rep(0,N-gene[2]),
rep(1,gene[1]))
x <- c(rep(0.5,54),rep(4,N),rep(8,N))
x2 <- x ^2
length(y)
m <- glm(y~x,family=binomial )
summary(m)
plot(fitted(m)~x,ylim=c(0,1))
s <- seq(0,8,length.out = 100)
predictions <- invlogit(predict(m,newdata = data.frame(x=s)))
lines(s,predictions)
min(which(predictions>0.95))
s[47]
gene <- x.ilsr
y <- c(rep(1,gene[3]),rep(0,N-gene[3]),
rep(1,gene[2]),rep(0,N-gene[2]),
rep(1,gene[1]))
x <- c(rep(0.5,54),rep(4,N),rep(8,N))
x2 <- x ^2
length(y)
m <- glm(y~x,family=binomial )
summary(m)
summary(m)
m <- glm(y~x,family=binomial )
gene <- x.ilsr
y <- c(rep(1,gene[3]),rep(0,N-gene[3]),
rep(1,gene[2]),rep(0,N-gene[2]),
rep(1,gene[1]),rep(0,N-gene[1]))
x <- c(rep(0.5,54),rep(4,N),rep(8,N))
x2 <- x ^2
length(y)
m <- glm(y~x,family=binomial )
summary(m)
plot(fitted(m)~x,ylim=c(0,1))
s <- seq(0,8,length.out = 100)
predictions <- invlogit(predict(m,newdata = data.frame(x=s)))
lines(s,predictions)
min(which(predictions>0.95))
s <- seq(0,20,length.out = 100)
predictions <- invlogit(predict(m,newdata = data.frame(x=s)))
lines(s,predictions)
plot(fitted(m)~x,ylim=c(0,1),xlim=c(0,20))
s <- seq(0,20,length.out = 100)
predictions <- invlogit(predict(m,newdata = data.frame(x=s)))
lines(s,predictions)
min(which(predictions>0.95))
y <- c(rep(1,gene[3]),rep(0,N-gene[3]),
rep(1,gene[2]),rep(0,N-gene[2]),
rep(1,gene[1]),rep(0,N-gene[1]))
y
x <- c(rep(0.5,54),rep(4,N),rep(8,N))
x2 <- x ^2
length(y)
m <- glm(y~x,family=binomial )
summary(m)
plot(fitted(m)~x,ylim=c(0,1),xlim=c(0,20))
s <- seq(0,20,length.out = 100)
predictions <- invlogit(predict(m,newdata = data.frame(x=s)))
lines(s,predictions)
min(which(predictions>0.95))
s[47]
s[min(which(predictions>0.95))]
abline(v=s[min(which(predictions>0.95))],col='red')
AIC(m)
plot(fitted(m)~log10(x),ylim=c(0,1),xlim=c(0,20))
m <- glm(y~log(x),family=binomial )
AIC(m)
m <- glm(y~log10(x),family=binomial )
AIC(m)
m <- glm(y~x,family=binomial )
summary(m)
AIC(m)
m <- glm(y~1,family=binomial,offset=x )
plot(fitted(m)~x,ylim=c(0,1),xlim=c(0,20))
s <- seq(0,20,length.out = 100)
predictions <- invlogit(predict(m,newdata = data.frame(x=s)))
lines(s,predictions)
s[min(which(predictions>0.95))]
abline(v=s[min(which(predictions>0.95))],col='red')
48/54
m <- glm(y~1,family=binomial,offset=log(x) )
plot(fitted(m)~x,ylim=c(0,1),xlim=c(0,20))
s <- seq(0,20,length.out = 100)
predictions <- invlogit(predict(m,newdata = data.frame(x=s)))
lines(s,predictions)
s[min(which(predictions>0.95))]
m <- glm(y~1,family=binomial,offset=x )
plot(fitted(m)~x,ylim=c(0,1),xlim=c(0,20))
s <- seq(0,20,length.out = 100)
predictions <- invlogit(predict(m,newdata = data.frame(x=s)))
lines(s,predictions)
s[min(which(predictions>0.95))]
abline(v=s[min(which(predictions>0.95))],col='red')
c
points(gene~c(c[3],c[2],c[1]),pch='X')
gene
points(gene/N~c(c[3],c[2],c[1]),pch='X')
plot(fitted(m)~x,ylim=c(0,1),xlim=c(0,20))
points(gene/N~c),pch='X')
points(gene/N ~ c,pch='X')
s <- seq(0,20,length.out = 100)
predictions <- invlogit(predict(m,newdata = data.frame(x=s)))
lines(s,predictions)
s[min(which(predictions>0.95))]
abline(v=s[min(which(predictions>0.95))],col='red')
33+ 2.131 * 12/4
y <- rnorm(16,33,12)
sqrt(var(y))
y <- rnorm(16,33,12)
sqrt(var(y))
y <- rnorm(16,33,12)
sqrt(var(y))
y <- rnorm(16,33,12)
sqrt(var(y))
y <- rnorm(16,33,12)
sqrt(var(y))
y <- rnorm(16,33,12)
sqrt(var(y))
y
y[1]=42
y[3]=39
y[3]=30
sqrt(var(y))
y[1]=40
sqrt(var(y))
y[1]=44
sqrt(var(y))
y[1]=46
sqrt(var(y))
mean(y)
mean(y)
sqrt(var(y))
(1/15)*sum(y-mean(y))
(1/15)*sum((y-mean(y))^2)
sqrt((1/15)*sum((y-mean(y))^2))
mean(y)+2.131 * sqrt(var(y))/4
t.test(y)
mean(y)-2.131 * sqrt(var(y))/4
qchisq(0.025,df=1)
qchisq(0.975,df=1)
pchiqs(3.84,1)
pchisq(3.84,1)
s <- rbinom(100,1,prob=0.5)
curve(x * (1-x),0,1)
m <- glm(s~1,family=binomial)
confint(m)
exp(confint(m))
invlogit(confint(m))
s <- rbinom(100,1,prob=0.1)
m <- glm(s~1,family=binomial)
invlogit(confint(m))
s <- rbinom(100,1,prob=0.01)
m <- glm(s~1,family=binomial)
invlogit(confint(m))
x <- rnorm(100)
mean(x)
sqrt(var(x))
rnorm(100*200,mean=mean(x),sd=sqrt(var(x)))
as.matrix(rnorm(100*200,mean=mean(x),sd=sqrt(var(x))),nrow=100,ncol=200)
m <- as.matrix(rnorm(100*200,mean=mean(x),sd=sqrt(var(x))),nrow=100,ncol=200)
dim(m)
rm(list=ls())
library(lme3)
library(lme4)
library(MASS)
library(nlme)
install.packages("miniCRAN")
